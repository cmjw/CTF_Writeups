# Basic Malware RE

## Part 1

Download and extract the .zip archive- the password is in the first task description (I did so in a virtual machine).

I first listed the string values in the executable using the *strings* function. This lists several flag-formatted values among other strings. One of these is likely the flag, but we don't know which one yet.

Next, I opened the program in Ghidra. Navigating to the entry point - the entry() function - we can see there is a string value moved to %eax and pushed onto the stack. Then the md5sum function is called, indicating this string value is probably a parameter to it.

In the decompiled view of entry(), we can see our intuition is correct. We see the md5_hash function is called with this flag-formatted string as a parameter. 

Searching for this value in the string view, we can find the full value of the flag.

## Part 2

I started by examining strings using the *strings* function. This time we do not see any flag-formatted values, however we do see the memset() and memcpy() functions, which may be useful for later.

Using Ghidra, I analyzed the program and navigated to the entry point. We can see in the disassembled instructions, several bytes are pushed onto the stack, followed by a call to the md5_hash function. 

Looking at the decompiled program, we can see strncpy() is used to copy the flag into memory.

## Part 3

This time, I am jumping straight into analysis using Ghidra. In the entry() function, analyzing the decompiled code reveals it uses the LoadStringA function from the Windows API.

I consulted the Windows documentation at https://learn.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-loadstringa. The uint, or the ID of the string is 0x110, the lpBuffer or buffer to recieve the string is a local variable local_4a4.

In Ghidra, highlighing this line, "LoadStringA((HINSTANCE0x0, 0x110, &local_4a4, 0x3ff)", will highlight the corresponding disassembled instructions. We can see Ghidra has filled in the value of the string on the right side of the instruction. 

Clicking on "call" will also take us to "Rsrc_StringTable_12_409", which lists the strings in the program. We can search for the string with the same ID as above (0x100, or 0d272), to verify the flag.
